# Script Provider Data - Execute installation scripts
version: "1.0"

provider:
  name: "script"
  display_name: "Script Installation"
  description: "Install software using custom installation scripts"
  type: "script"
  platforms: ["linux", "macos", "windows"]
  executable: "bash"  # Script interpreter for availability detection
  capabilities: ["install", "uninstall", "upgrade", "version", "info"]

actions:
  install:
    description: "Download and execute installation script"
    steps:
      - name: "create-temp-dir"
        command: "mkdir -p /tmp/sai-script-install"
      - name: "download-script"
        command: "cd /tmp/sai-script-install && curl -fsSL {{sai_script(0, 'url', 'script')}} -o install.sh"
      - name: "set-script-permissions"
        command: "chmod +x /tmp/sai-script-install/install.sh"
      - name: "execute-script"
        command: "cd {{sai_script(0, 'working_dir', 'script')}} && {{sai_script(0, 'interpreter', 'script')}} /tmp/sai-script-install/install.sh {{sai_script('*', 'arguments', 'script')}}"
        timeout: "{{sai_script(0, 'timeout', 'script')}}"
      - name: "cleanup-temp"
        command: "rm -rf /tmp/sai-script-install"
        ignore_failure: true
    timeout: 1800

  uninstall:
    description: "Remove script-installed software"
    template: "echo 'Manual uninstall required for script-installed software'"

  upgrade:
    description: "Upgrade script-installed software"
    steps:
      - name: "create-temp-dir"
        command: "mkdir -p /tmp/sai-script-upgrade"
      - name: "download-new-script"
        command: "cd /tmp/sai-script-upgrade && curl -fsSL {{sai_script(0, 'url', 'script')}} -o install.sh"
      - name: "set-new-script-permissions"
        command: "chmod +x /tmp/sai-script-upgrade/install.sh"
      - name: "execute-upgrade-script"
        command: "cd {{sai_script(0, 'working_dir', 'script')}} && {{sai_script(0, 'interpreter', 'script')}} /tmp/sai-script-upgrade/install.sh {{sai_script('*', 'arguments', 'script')}}"
        timeout: "{{sai_script(0, 'timeout', 'script')}}"
      - name: "cleanup-temp"
        command: "rm -rf /tmp/sai-script-upgrade"
        ignore_failure: true
    timeout: 1800

  version:
    description: "Show installed version"
    template: "echo 'Version: {{sai_script(0, 'version', 'script')}}'"

  info:
    description: "Show script installation information"
    template: "echo 'Script URL: {{sai_script(0, 'url', 'script')}}' && echo 'Interpreter: {{sai_script(0, 'interpreter', 'script')}}' && echo 'Timeout: {{sai_script(0, 'timeout', 'script')}}s'"