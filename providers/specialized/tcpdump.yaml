# TCPDUMP Provider Data - Network packet analyzer
version: "1.0"

provider:
  name: "tcpdump"
  display_name: "Network Packet Analyzer"
  description: "Network packet capture and analysis using tcpdump"
  type: "network"
  platforms: ["linux", "macos"]
  executable: "tcpdump"  # Main executable for availability detection
  capabilities: ["logs", "info", "search", "list", "status"]

actions:
  logs:
    description: "Capture network packets"
    template: "tcpdump -i {{interface}} port {{sai_port(saidata) or '80'}} -c {{packet_count}}"
    variables:
      interface: "any"
      packet_count: "100"

  info:
    description: "Filter specific traffic"
    template: "tcpdump -i {{interface}} host {{target_host}} and port {{sai_port(saidata) or '80'}}"
    variables:
      interface: "any"
      target_host: "localhost"

  search:
    description: "Capture to file"
    template: "tcpdump -i {{interface}} -w /tmp/tcpdump-{{saidata.metadata.name}}.pcap port {{sai_port(saidata) or '80'}}"
    variables:
      interface: "any"

  list:
    description: "List available interfaces"
    template: "tcpdump -D"

  status:
    description: "Verbose packet capture"
    template: "tcpdump -v -i {{interface}} port {{sai_port(saidata) or '80'}} -c {{packet_count}}"
    variables:
      interface: "any"
      packet_count: "10"
