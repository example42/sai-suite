# FIND Provider Data - Find files and directories
version: "1.0"

provider:
  name: "find"
  display_name: "File Finder"
  description: "Find files and directories using find command"
  type: "filesystem"
  platforms: ["linux", "macos", "windows"]
  capabilities: ["search", "list", "info", "uninstall", "upgrade"]

actions:
  search:
    description: "Search for files by name"
    template: "find {{search_path}} -name '*{{saidata.metadata.name}}*'"
    variables:
      search_path: "/usr /etc /var"

  list:
    description: "Execute command on found files"
    template: "find {{search_path}} -name '*{{saidata.metadata.name}}*' -exec ls -la {} \\;"
    variables:
      search_path: "/usr /etc /var"

  info:
    description: "Find by file type"
    template: "find {{search_path}} -name '*{{saidata.metadata.name}}*' -type {{file_type}}"
    variables:
      search_path: "/usr /etc /var"
      file_type: "f"

  uninstall:
    description: "Delete found files"
    template: "find {{search_path}} -name '*{{saidata.metadata.name}}*' -delete"
    variables:
      search_path: "/tmp"

  upgrade:
    description: "Find by size and time"
    template: "find {{search_path}} -name '*{{saidata.metadata.name}}*' -size +{{min_size}} -mtime -{{days}}"
    variables:
      search_path: "/var/log"
      min_size: "1M"
      days: "7"

mappings:
  packages:
    server:
      name: "{{saidata.metadata.name}}"

  services:
    main:
      name: "{{saidata.metadata.name}}"
      type: "filesystem_target"

  files:
    log:
      path: "/tmp/find-{{saidata.metadata.name}}.log"
      owner: "$(whoami)"
      group: "$(whoami)"
      mode: "0644"

  directories:
    search:
      path: "/tmp/search-{{saidata.metadata.name}}"
      owner: "$(whoami)"
      group: "$(whoami)"
      mode: "0755"
    data:
      path: "{{saidata.directories.data.path}}"
    config:
      path: "{{saidata.directories.config.path}}"

  commands:
    server:
      path: "{{saidata.commands.server.path}}"
    search:
      path: "find /usr -name '*{{saidata.metadata.name}}*'"

  variables:
    "*":
      config_key: "{{variable_name}}"