# IFTOP Provider Data - Network bandwidth by connection
version: "1.0"

provider:
  name: "iftop"
  display_name: "Interface Top"
  description: "Network bandwidth monitoring by connection using iftop"
  type: "network"
  platforms: ["linux", "macos"]
  capabilities: ["status", "info", "logs", "list", "search"]

actions:
  status:
    description: "Monitor network bandwidth"
    template: "iftop -i {{interface}}"
    variables:
      interface: "any"

  info:
    description: "Monitor specific interface"
    template: "iftop -i {{interface}} -P"
    variables:
      interface: "eth0"

  logs:
    description: "Monitor specific port"
    template: "iftop -i {{interface}} -f 'port {{sai_port(saidata) or '80'}}'"
    variables:
      interface: "any"

  list:
    description: "Monitor specific host"
    template: "iftop -i {{interface}} -f 'host {{target_host}}'"
    variables:
      interface: "any"
      target_host: "localhost"

  search:
    description: "Filter network traffic"
    template: "iftop -i {{interface}} -f '{{filter_expression}}'"
    variables:
      interface: "any"
      filter_expression: "port {{sai_port(saidata) or '80'}}"
