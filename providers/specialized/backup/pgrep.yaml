# PGREP Provider Data - Process grep and management
version: "1.0"

provider:
  name: "pgrep"
  display_name: "Process Grep"
  description: "Process grep and management using pgrep/pkill"
  type: "process"
  platforms: ["linux", "macos"]
  capabilities: ["search", "list", "info", "status", "stop"]

actions:
  search:
    description: "Find processes by name"
    template: "pgrep -f {{saidata.metadata.name}}"

  list:
    description: "List matching processes with details"
    template: "pgrep -l -f {{saidata.metadata.name}}"

  info:
    description: "Show process information"
    template: "pgrep -a -f {{saidata.metadata.name}}"

  status:
    description: "Check if process exists"
    template: "pgrep -c -f {{saidata.metadata.name}}"
    validation:
      command: "pgrep -f {{saidata.metadata.name}}"
      expected_exit_code: 0

  stop:
    description: "Kill processes by name"
    template: "pkill -f {{saidata.metadata.name}}"
    validation:
      command: "! pgrep -f {{saidata.metadata.name}}"
      expected_exit_code: 0
