# PKILL Provider Data - Kill processes by name/criteria
version: "1.0"

provider:
  name: "pkill"
  display_name: "Process Kill"
  description: "Kill processes by name or criteria using pkill"
  type: "process"
  platforms: ["linux", "macos"]
  capabilities: ["stop", "restart", "status", "info"]

actions:
  stop:
    description: "Kill processes by name"
    template: "pkill -f {{saidata.metadata.name}}"
    validation:
      command: "! pgrep -f {{saidata.metadata.name}}"
      expected_exit_code: 0

  restart:
    description: "Kill and restart processes"
    steps:
      - name: "kill-process"
        command: "pkill -f {{saidata.metadata.name}}"
        ignore_failure: true
      - name: "wait-termination"
        command: "sleep {{restart_delay}}"
      - name: "start-process"
        command: "{{saidata.commands[0].path if saidata.commands else saidata.metadata.name}} &"
    variables:
      restart_delay: "2"

  status:
    description: "Check process status before kill"
    template: "pgrep -f {{saidata.metadata.name}} && echo 'Process found' || echo 'Process not found'"

  info:
    description: "Show processes that would be killed"
    template: "pgrep -a -f {{saidata.metadata.name}}"
